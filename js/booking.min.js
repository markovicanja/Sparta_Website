currentExercise="";

translator=[];
translator['Mon']='Pon';
translator['Tue']='Uto';
translator['Wed']='Sre';
translator['Thu']='Čet';
translator['Fri']='Pet';
translator['Sat']='Sub';
translator['Sun']='Ned';

reverseTranslator=[];
reverseTranslator['Pon']='Mon';
reverseTranslator['Uto']='Tue';
reverseTranslator['Sre']='Wed';
reverseTranslator['Čet']='Thu';
reverseTranslator['Pet']='Fri';
reverseTranslator['Sub']='Sat';
reverseTranslator['Ned']='Sun';

translatorWorkouts=[];
translatorWorkouts['Morning yoga']='Jutarnja joga';
translatorWorkouts['Ashtanga yoga']='Aštanga joga';
translatorWorkouts['Hatha yoga']='Hatha joga';
translatorWorkouts['Classic pilates']='Klasični pilates';
translatorWorkouts['Reformer pilates']='Reformer pilates';
translatorWorkouts['Stott pilates']='Stot pilates';
translatorWorkouts['Body sculpting']='Body sculpting';
translatorWorkouts['Crossfit']='Crossfit';
translatorWorkouts['Spartan']='Spartanac';
translatorWorkouts['Core']='Core';
translatorWorkouts['Cardio Box']='Kardio Boks';
translatorWorkouts['Zumba']='Zumba';
translatorWorkouts['Aerobic attack']='Aerobni napad';

reverseTranslatorWorkouts=[];
reverseTranslatorWorkouts['Jutarnja joga']='Morning yoga';
reverseTranslatorWorkouts['Aštanga joga']='Ashtanga yoga';
reverseTranslatorWorkouts['Hatha joga']='Hatha yoga';
reverseTranslatorWorkouts['Klasični pilates']='Classic pilates';
reverseTranslatorWorkouts['Reformer pilates']='Reformer pilates';
reverseTranslatorWorkouts['Stot pilates']='Stott pilates';
reverseTranslatorWorkouts['Body sculpting']='Body sculpting';
reverseTranslatorWorkouts['Crossfit']='Crossfit';
reverseTranslatorWorkouts['Spartanac']='Spartan';
reverseTranslatorWorkouts['Core']='Core';
reverseTranslatorWorkouts['Kardio Boks']='Cardio Box';
reverseTranslatorWorkouts['Zumba']='Zumba';
reverseTranslatorWorkouts['Aerobni napad']='Aerobic attack';

function initIndex() {

    cnt=sessionStorage.getItem("cnt");
    if (cnt==null) {

        if (sessionStorage.getItem("language")==null) {   
            sessionStorage.setItem("language", "srb");
        }

        cnt=1;
        sessionStorage.setItem("cnt", cnt);
        sessionStorage.setItem("cntA", "0");
        sessionStorage.setItem("cntJ", "0");
        sessionStorage.setItem("rowID", "100");
        sessionStorage.setItem("removed", "");
        sessionStorage.setItem("removedNum", "0");
        sessionStorage.setItem("allReserved", "");

        ratings={
            "morningYoga": "4.5",
            "ashtangaYoga": "4.9",
            "hathaYoga": "4.5",
            "classicPilates": "4.3",
            "stottPilates": "4.4",
            "reformerPilates": "4.5",
            "crossfit": "4.5",
            "aerobicAttack": "4.3",
            "spartan": "5",
            "bodySculpting": "4.2",
            "cardioBox": "4.9",
            "zumba": "4.4",
            "core": "4.2" 
        }
        sessionStorage.setItem("ratings", JSON.stringify(ratings));

        userExercises=new Array();
        alreadyRated=new Array();
        sessionStorage.setItem("alreadyRated", JSON.stringify(alreadyRated));
        var s = Math.random() < 0.5 ? "male" : "female";
        if (s == "male") {
            sessionStorage.setItem("user", "Adrian");
            userExercises.push("spartan");
            userExercises.push("core");
            userExercises.push("cardioBox");
            userExercises.push("crossfit");
            sessionStorage.setItem("userExercises", JSON.stringify(userExercises));
        }
        else {
            sessionStorage.setItem("user", "Jelica");
            userExercises.push("hathaYoga");
            userExercises.push("reformerPilates");
            userExercises.push("stottPilates");
            userExercises.push("aerobicAttack");
            sessionStorage.setItem("userExercises", JSON.stringify(userExercises));
        }

        sessionStorage.setItem("morningYogaAddedComments", JSON.stringify(Array()));
        sessionStorage.setItem("ashtangaYogaAddedComments", JSON.stringify(Array()));
        sessionStorage.setItem("hathaYogaAddedComments", JSON.stringify(Array()));
        sessionStorage.setItem("classicPilatesAddedComments", JSON.stringify(Array()));
        sessionStorage.setItem("reformerPilatesAddedComments", JSON.stringify(Array()));
        sessionStorage.setItem("stottPilatesAddedComments", JSON.stringify(Array()));
        sessionStorage.setItem("bodySculptingAddedComments", JSON.stringify(Array()));
        sessionStorage.setItem("coreAddedComments", JSON.stringify(Array()));
        sessionStorage.setItem("spartanAddedComments", JSON.stringify(Array()));
        sessionStorage.setItem("crossfitAddedComments", JSON.stringify(Array()));
        sessionStorage.setItem("aerobicAttackAddedComments", JSON.stringify(Array()));
        sessionStorage.setItem("zumbaAddedComments", JSON.stringify(Array()));
        sessionStorage.setItem("cardioBoxAddedComments", JSON.stringify(Array()));

        allSlots = {
            "Jutarnja joga": {
                "Pon":"3",
                "Sre":"4",
                "Pet":"5"
            },
            "Aštanga joga": {
                "Uto":"1",
                "Čet":"2",
                "Sub":"3"
            },
            "Hatha joga": {
                "Uto":"1",
                "Pet":"2",
                "Ned":"3"
            },
            "Klasični pilates": {
                "Pon":"1",
                "Sre":"2",
                "Pet":"3"
            },
            "Reformer pilates": {
                "Uto":"1",
                "Čet":"2"
            },
            "Stot pilates": {
                "Čet":"2",
                "Ned":"3"
            },
            "Crossfit": {
                "Pon":"1",
                "Sre":"2",
                "Sub":"3"
            },
            "Spartanac": {
                "Pon":"1",
                "Sre":"2",
                "Pet":"3"
            },
            "Body sculpting": {
                "Uto":"1",
                "Čet":"2"
            },
            "Core": {
                "Pon":"1",
                "Sre":"2",
                "Pet":"3"
            },
            "Kardio Boks": {
                "Uto":"1",
                "Čet":"2",
                "Sub":"3"
            },
            "Aerobni napad": {
                "Pon":"1",
                "Sre":"2",
                "Pet":"3"
            },
            "Zumba": {
                "Sre":"1",
                "Sub":"3"
            }
        }

        sessionStorage.setItem("allSlots", JSON.stringify(allSlots));
    }

    ocena="Ocena: ";
    if (sessionStorage.getItem("language")=="eng") ocena="Rating: ";

    ratings=JSON.parse(sessionStorage.getItem("ratings"));
    $('#ocena1').text(ocena+ratings['spartan']+"/5");
    popuniZvezdice('zvezdice1', ratings['spartan']);
    $('#ocena2').text(ocena+ratings['cardioBox']+"/5");
    popuniZvezdice('zvezdice2', ratings['cardioBox']);
    $('#ocena3').text(ocena+ratings['ashtangaYoga']+"/5");
    popuniZvezdice('zvezdice3', ratings['ashtangaYoga']);
}

function popuniZvezdice(id, rating) {
    content='';
    for (i=0; i<5; i++) {
        if (rating>=(i+1)) content+='<span class="fa fa-star checked"></span>';
        else content+='<span class="fa fa-star"></span>';
    }
    $('#'+id).html(content);
}   

function prev() {
    document.getElementById('slider-container').scrollLeft -= 270;
}

function next() {
    document.getElementById('slider-container').scrollLeft += 270;
}

function rowFilter(activeText, onclickText, idText, justText) {
    return '<li class="list-group-item '+activeText+'" onclick="'+onclickText+'" id="'+idText+'">'+justText+'</li>';
}

function rowExercise(activeText, idText, justText) {
    common='" onclick="clickExercise(this.id)';
    return '<li class="list-group-item '+activeText+'" id="'+idText+common+'">'+justText+'</li>';
}

function rowDay(justText, num, buttonID) {

    language=sessionStorage.getItem("language");
    buttonText="Rezerviši";
    if (language=="eng") buttonText="Reserve";

    button='';
    if (num=="0") num='';
    if (num!='') button='<button type="button" class="btn btn-secondary" id="' + buttonID + '" onclick="buttonClick(this.id)">'+buttonText+'</button>';
    return '<li class="list-group-item d-flex justify-content-between align-items-center">'+justText+'<span class="badge badge-secondary badge-pill">'+num+'</span>'+
        button+'</li>'; 
}

function filter(id) {

    language=sessionStorage.getItem("language");

    active1=active2=active3=active4=active5='';
    if (id=='AllFilter') active1="active";
    if (id=='YogaFilter') active2="active";
    if (id=='PilatesFilter') active3="active";
    if (id=='CoreFilter') active4="active";
    if (id=='CardioFilter') active5="active";

    if (language=="srb") {
        newInnerHTML=rowFilter(active1,"filter(this.id)", "AllFilter","Sve")+
            rowFilter(active2,"filter(this.id)", "YogaFilter","Yoga")+
            rowFilter(active3,"filter(this.id)", "PilatesFilter","Pilates")+
            rowFilter(active4,"filter(this.id)", "CoreFilter","Tegovi")+
            rowFilter(active5,"filter(this.id)", "CardioFilter","Kardio");
        document.getElementById('listFilter').innerHTML=newInnerHTML;

        morningYoga="Jutarnja joga";
        ashtangaYoga="Aštanga joga";
        hathaYoga="Hatha joga";
        classicPilates="Klasični pilates";
        reformerPilates="Reformer pilates";
        stottPilates="Stot pilates";
        crossfit="Crossfit";
        spartan="Spartanac";
        bodySculpting="Body sculpting";
        core="Core";
        cardioBox="Kardio Boks";
        aerobicAttack="Aerobni napad";
        zumba="Zumba";
    } 
    else {
        newInnerHTML=rowFilter(active1,"filter(this.id)", "AllFilter","All")+
            rowFilter(active2,"filter(this.id)", "YogaFilter","Yoga")+
            rowFilter(active3,"filter(this.id)", "PilatesFilter","Pilates")+
            rowFilter(active4,"filter(this.id)", "CoreFilter","Weights")+
            rowFilter(active5,"filter(this.id)", "CardioFilter","Cardio");
        document.getElementById('listFilter').innerHTML=newInnerHTML;

        morningYoga="Morning yoga";
        ashtangaYoga="Ashtanga yoga";
        hathaYoga="Hatha yoga";
        classicPilates="Classic pilates";
        reformerPilates="Reformer pilates";
        stottPilates="Stott pilates";
        crossfit="Crossfit";
        spartan="Spartan";
        bodySculpting="Body sculpting";
        core="Core";
        cardioBox="Cardio Box";
        aerobicAttack="Aerobic attack";
        zumba="Zumba";
    }

    if (id=='AllFilter') {
        document.getElementById('hiddenFilter').value="Sve";
        currentExercise=firstExercise=morningYoga;
        newInnerHTML=rowExercise("active", "1", morningYoga)+
        rowExercise("", "2", ashtangaYoga)+
        rowExercise("", "3", hathaYoga)+
        rowExercise("", "4", classicPilates)+
        rowExercise("", "5", reformerPilates)+
        rowExercise("", "6", stottPilates)+
        rowExercise("", "7", crossfit)+
        rowExercise("", "8", spartan)+
        rowExercise("", "9", bodySculpting)+
        rowExercise("", "10", core)+
        rowExercise("", "11", cardioBox)+
        rowExercise("", "12", aerobicAttack)+
        rowExercise("", "13", zumba);
        document.getElementById('listExercise').innerHTML=newInnerHTML;
    }
    if (id=='YogaFilter') {
        document.getElementById('hiddenFilter').value="Yoga";
        currentExercise=firstExercise=morningYoga;
        newInnerHTML=rowExercise("active", "1", morningYoga)+
        rowExercise("", "2", ashtangaYoga)+
        rowExercise("", "3", hathaYoga);
        document.getElementById('listExercise').innerHTML=newInnerHTML;
    }
    if (id=='PilatesFilter') {
        document.getElementById('hiddenFilter').value="Pilates";
        currentExercise=firstExercise=classicPilates;
        newInnerHTML=rowExercise("active", "4", classicPilates)+
        rowExercise("", "5", reformerPilates)+
        rowExercise("", "6", stottPilates);
        document.getElementById('listExercise').innerHTML=newInnerHTML;
    }
    if (id=='CoreFilter') {
        document.getElementById('hiddenFilter').value="Core";
        currentExercise=firstExercise=crossfit;
        newInnerHTML=rowExercise("active", "7", crossfit)+
        rowExercise("", "8", spartan)+
        rowExercise("", "9", bodySculpting)+
        rowExercise("", "10", core);
        document.getElementById('listExercise').innerHTML=newInnerHTML;
    }
    if (id=='CardioFilter') {
        document.getElementById('hiddenFilter').value="Cardio";
        currentExercise=firstExercise=cardioBox;
        newInnerHTML=rowExercise("active", "11", cardioBox)+
        rowExercise("", "12", aerobicAttack)+
        rowExercise("", "13", zumba);
        document.getElementById('listExercise').innerHTML=newInnerHTML;
    }

    checkDays(firstExercise);
}

function clickExercise(id) {
    
    currFilter=document.getElementById('hiddenFilter').value;
    active=['','','','','','','','','','','','','',''];

    active[id]='active';
    currentExercise=exerciseName=document.getElementById(id).textContent;
    completeHTML='';

    language=sessionStorage.getItem("language");
    if (language=="srb") {
        morningYoga="Jutarnja joga";
        ashtangaYoga="Aštanga joga";
        hathaYoga="Hatha joga";
        classicPilates="Klasični pilates";
        reformerPilates="Reformer pilates";
        stottPilates="Stot pilates";
        crossfit="Crossfit";
        spartan="Spartanac";
        bodySculpting="Body sculpting";
        core="Core";
        cardioBox="Kardio Boks";
        aerobicAttack="Aerobni napad";
        zumba="Zumba";
    }
    else {
        morningYoga="Morning yoga";
        ashtangaYoga="Ashtanga yoga";
        hathaYoga="Hatha yoga";
        classicPilates="Classic pilates";
        reformerPilates="Reformer pilates";
        stottPilates="Stott pilates";
        crossfit="Crossfit";
        spartan="Spartan";
        bodySculpting="Body sculpting";
        core="Core";
        cardioBox="Cardio Box";
        aerobicAttack="Aerobic attack";
        zumba="Zumba";
    }

    if (currFilter=='Sve' || currFilter=='Yoga') completeHTML+=rowExercise(active[1], "1", morningYoga);
    if (currFilter=='Sve' || currFilter=='Yoga') completeHTML+=rowExercise(active[2], "2", ashtangaYoga);
    if (currFilter=='Sve' || currFilter=='Yoga') completeHTML+=rowExercise(active[3], "3", hathaYoga);
    if (currFilter=='Sve' || currFilter=='Pilates') completeHTML+=rowExercise(active[4], "4", classicPilates);
    if (currFilter=='Sve' || currFilter=='Pilates') completeHTML+=rowExercise(active[5], "5", reformerPilates);
    if (currFilter=='Sve' || currFilter=='Pilates') completeHTML+=rowExercise(active[6], "6", stottPilates);
    if (currFilter=='Sve' || currFilter=='Core') completeHTML+=rowExercise(active[7], "7", crossfit);
    if (currFilter=='Sve' || currFilter=='Core') completeHTML+=rowExercise(active[8], "8", spartan);
    if (currFilter=='Sve' || currFilter=='Core') completeHTML+=rowExercise(active[9], "9", bodySculpting);
    if (currFilter=='Sve' || currFilter=='Core') completeHTML+=rowExercise(active[10], "10", core);
    if (currFilter=='Sve' || currFilter=='Cardio') completeHTML+=rowExercise(active[11], "11", cardioBox);
    if (currFilter=='Sve' || currFilter=='Cardio') completeHTML+=rowExercise(active[12], "12", aerobicAttack);
    if (currFilter=='Sve' || currFilter=='Cardio') completeHTML+=rowExercise(active[13], "13", zumba);

    document.getElementById('listExercise').innerHTML=completeHTML;
    checkDays(exerciseName);
}

function filter1() {filter('AllFilter');}

setTimeout(function filter1(){
    document.getElementById('listDay').innerHTML='';
    filter('AllFilter');
}, 50);



function checkDays(exercise) {


    svakiDan=[6, 11, 18, 23, 29, 33, 35];
    j=0;

    dani=document.getElementById('raspored').getElementsByClassName("top-info");
    treninzi=document.getElementById('raspored').getElementsByClassName("single-event");
    document.getElementById('listDay').innerHTML='';

    buttonID=50;
    for (i=0; i<dani.length ; i++) {
        dan=dani[i].textContent;
        for (; j<svakiDan[i]; j++) {
            trening=treninzi[j].textContent;
            patt = new RegExp(exercise);
            if (patt.exec(trening)!=null) {
                buttonID++;
                red='';
                dan=dan.replace(/\s/g, '').substr(0,3)+'  ';
                trening=trening.replace(/\s/g, '').substr(0,11);
                trening=trening.slice(0,5)+' '+'-'+' '+trening.slice(6,11);
                red+=dan;
                red+=trening;

                realExercise=exercise;

                danBezRazmaka=dan.substr(0,3);
                if (sessionStorage.getItem("language")=="eng") {
                    danBezRazmaka=translator[danBezRazmaka];
                    exercise=translatorWorkouts[exercise];
                }
                allSlots=JSON.parse(sessionStorage.getItem("allSlots"));
                broj=allSlots[exercise][danBezRazmaka];

                exercise=realExercise;

                document.getElementById('listDay').innerHTML+=rowDay(red, broj, buttonID);
            }
        } 
    }
}


function buttonClick(id) {

    dani={};
    dani['Ned']=0; dani['Pon']=1; dani['Uto']=2; dani['Sre']=3; dani['Čet']=4; dani['Pet']=5; dani['Sub']=6;
    danVreme=document.getElementById(id).parentElement.textContent.slice(0,18);
    trening=currentExercise;
    
    dan=danVreme.slice(0,3);
    if (sessionStorage.getItem("language")=="eng") {
        dan=translator[dan];
        trening=translatorWorkouts[trening];
    }
    imeDana=dan;
    dan=dani[dan];
    vreme=danVreme.slice(5,18);

    sledeciDan=new Date();
    i=0;
    while (dan!=sledeciDan.getDay()) {
        sledeciDan.setDate(new Date().getDate()+i);
        i++;
    }
    if (i==0) {
        trenutnoSati=(new Date()).getHours();
        treningPocinje=vreme.slice(0,2);
        if (treningPocinje.charAt(0)=='0') treningPocinje=treningPocinje.slice(1,2);
        if (treningPocinje<=trenutnoSati) sledeciDan.setDate(new Date().getDate()+7);
    }
    reservePlace(sledeciDan, vreme, imeDana, trening);
}

function reservePlace(date, time, dayName, exercise) {

    trening=exercise;
    zero='';
    if (date.getMonth()<9) zero='0';
    datum=date.toString().slice(8,10)+'.'+zero+(date.getMonth()+1)+'.'+(date.getYear()+1900);
    vreme=time.slice(0,5);
    termin=datum+' '+vreme+' '+dayName+' '+trening;

    allReserved=sessionStorage.getItem("allReserved");
    tryToReserve=new RegExp(trening+dayName);
    if (tryToReserve.exec(allReserved)!=null) return;
    allReserved+=tryToReserve;
    sessionStorage.setItem("allReserved", allReserved);

    countAdrian=sessionStorage.getItem("cntA");
    countJelica=sessionStorage.getItem("cntJ");

    user=sessionStorage.getItem("user");
    index='';
    if (user=="Adrian") {
        index='numA'+countAdrian;
        countAdrian++;
    }
    else {
        index='numJ'+countJelica;
        countJelica++;
    }

    sessionStorage.setItem('cntA', countAdrian);
    sessionStorage.setItem('cntJ', countJelica);
    sessionStorage.setItem(index, termin);

    allSlots=JSON.parse(sessionStorage.getItem("allSlots"));
    allSlots[trening][dayName]-=1;
    sessionStorage.setItem("allSlots",JSON.stringify(allSlots));

    if (sessionStorage.getItem("language")=="eng") trening=reverseTranslatorWorkouts[trening];
    checkDays(trening);
} 

function logOut() {

    language=sessionStorage.getItem("language");

    sessionStorage.clear();

    sessionStorage.setItem("language", language);

}

initialHTML='<table><thead></thead><tr><td colspan="4" align="center">Nemate zakazanih termina</td></tr></table>';
initialHTMLeng='<table><thead></thead><tr><td colspan="4" align="center">You have no appointments</td></tr></table>';

function cancelPlace(rowID) {

    rowID="#"+rowID;
    currentRow=$(rowID);
    imeTreningaZaBrisanje=currentRow.find("td:eq(0)").text();
    vremeTreningaZaBrisanje=currentRow.find("td:eq(2)").text();
    imeDanaTreningaZaBrisanje=currentRow.find("td:eq(3)").text();

    if (sessionStorage.getItem("language")=="eng") {
        imeTreningaZaBrisanje=translatorWorkouts[imeTreningaZaBrisanje];
        imeDanaTreningaZaBrisanje=translator[imeDanaTreningaZaBrisanje];
    }

    allSlots=JSON.parse(sessionStorage.getItem("allSlots"));
    allSlots[imeTreningaZaBrisanje][imeDanaTreningaZaBrisanje]+=1;
    sessionStorage.setItem("allSlots", JSON.stringify(allSlots));

    allReserved=sessionStorage.getItem("allReserved");
    allReserved=allReserved.replace(imeTreningaZaBrisanje+imeDanaTreningaZaBrisanje, "/");
    sessionStorage.setItem("allReserved", allReserved);

    $(rowID).remove();
    count=0;
    if (user=="Adrian") {
        count=sessionStorage.getItem("cntA");
    }
    else {
        count=sessionStorage.getItem("cntJ");
    }
    removed=sessionStorage.getItem("removed");
    removedNum=parseInt(sessionStorage.getItem("removedNum"));
    removed=""+removed+rowID;
    removedNum+=1;
    sessionStorage.setItem("removed", removed);
    sessionStorage.setItem("removedNum", removedNum);
    if (removedNum==count) {
        if (sessionStorage.getItem("language")=="srb") document.getElementById('res').innerHTML=initialHTML;
        else document.getElementById('res').innerHTML=initialHTMLeng;
    }
}

function languageSerbian() {
    sessionStorage.setItem("language", "srb");
}

function languageEnglish() {
    sessionStorage.setItem("language", "eng");
}

function init() {

    user=sessionStorage.getItem("user");
    count=0;
    char='';

    if (user=="Adrian") {
        document.getElementById("avatar").src="./images/male.jpg";
        document.getElementById("name").innerHTML="Adrian Milaković";
        count=sessionStorage.getItem('cntA');
        char='A';
    }
    else {
        document.getElementById("avatar").src="./images/female.jpg";
        document.getElementById("name").innerHTML="Jelica Cincović";
        count=sessionStorage.getItem('cntJ');
        char='J';
    }
    

    full='';
    rowID=100;
    removed=sessionStorage.getItem("removed");
    removedNum=sessionStorage.getItem("removedNum");
    if (sessionStorage.getItem("language")=="srb") {
        full="<table><thead><th>Trening</th><th>Datum</th><th>Vreme</th><th>Dan</th><th>Otkazivanje</th></thead>";
    }
    else {
        full="<table><thead><th>Workout</th><th>Date</th><th>Time</th><th>Day</th><th>Cancellation</th></thead>";
    }

    danas=new Date();
    zero='';
    if (danas.getMonth()<9) zero='0';
    danasDatum=danas.toString().slice(8,10)+'.'+zero+(danas.getMonth()+1)+'.'+(danas.getYear()+1900);
    danDanas=danasDatum.slice(0,2);
    mesecDanas=danasDatum.slice(3,5);
    godinaDanas=danasDatum.slice(6,10);
    satDanas=danas.getHours();
    minutDanas=danas.getMinutes();
    // alert(danDanas+ ' ' + mesecDanas + ' ' + godinaDanas + ' ' + satDanas + ' ' + minutDanas);

    if (count==removedNum) {
        if (sessionStorage.getItem("language")=="srb") {
            document.getElementById('res').innerHTML=initialHTML;
        }
        else {
            document.getElementById('res').innerHTML=initialHTMLeng;
        }
        return;
    }

        for (i=0; i<count; i++) {
            index='num'+char+i;
            item=sessionStorage.getItem(index);
            
            datum=item.slice(0,10);
            vreme=item.slice(11,16);
            imeDana=item.slice(17,20);
            ime=item.substring(21);

            
            // alert(datum+' '+ vreme+ ' '+ imeDana+ ' '+ ime);

            dan=datum.slice(0,2);
            mesec=datum.slice(3,5);
            godina=datum.slice(6,10);
            sat=parseInt(vreme.slice(0,2));
            minut=parseInt(vreme.slice(3,5));
            // alert(dan+ ' ' + mesec + ' ' + godina + ' ' + sat + ' ' + minut);

            moze=true;
            if (danDanas==dan && mesecDanas==mesec && godinaDanas==godina && satDanas==sat && (minut-minutDanas<30)) moze=false;

            rowID++;
            currRow=new RegExp(rowID);
            removed=sessionStorage.getItem("removed");
            if (currRow.exec(removed)==null) {
                otkazi="Otkaži";
                if (sessionStorage.getItem("language")=="eng") {
                    ime=reverseTranslatorWorkouts[ime];
                    imeDana=reverseTranslator[imeDana];
                    otkazi="Cancel";
                }
                full+='<tr id="'+rowID+'"><td>'+ime+'</td><td>'+datum+'</td><td>'+vreme+'</td>'+'<td>'+imeDana+'</td>';
                if (moze) {
                    full+='<td><input type="button" class="btn" value="'+otkazi+'" onclick="cancelPlace('+rowID+')"></td></tr>';
                }        
            }
        }

        full+="</table>";

        document.getElementById('res').innerHTML=full;
}        